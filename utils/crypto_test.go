package utils

import (
	"encoding/base64"
	"encoding/json"
	"fmt"
	"testing"

	"github.com/MoonlightPS/Iridium-gidra/gover/gen"
	"google.golang.org/protobuf/proto"
)

func TestCrypto(t *testing.T) {
	err := InitKey("../../keys")
	if err != nil {
		panic(err)
	}

	regionInfoStr := "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"
	regionInfoBytes, err := base64.StdEncoding.DecodeString(regionInfoStr)
	if err != nil {
		panic(err)
	}

	decrypted, err := Decrypt(regionInfoBytes, CN_KEY)
	if err != nil {
		panic(err)
	}

	regionInfo := &gen.QueryCurrRegionHttpRsp{}
	err = proto.Unmarshal(decrypted, regionInfo)
	if err != nil {
		panic(err)
	}

	js, err := json.Marshal(regionInfo)
	if err != nil {
		panic(err)
	}

	fmt.Println(string(js))
}
